# install_eicar_av_test.sh
# EICAR Outbound Router AV Test (Svoto)

Author: **Steve Voto (Svoto)**  
License: **MIT-style** (see disclaimer below)

This tool automatically sends **EICAR antivirus test patterns** through your router/gateway on a schedule so you can verify that:

- Router / firewall **antivirus** is actually inspecting outbound traffic  
- **IDPS / security logging** is working  
- Encrypted / encoded paths (HTTPS, Base64, WebSocket-like traffic, etc.) are being inspected correctly, if configured  

By default, the included installer sets up a **systemd service + timer** that runs the full test **every 12 hours**, with **no user interaction**.

---

## ⚠️ Safety & Legal Disclaimer

- This tool uses the **standard EICAR test string**, *not* real malware.
- It is intended **ONLY** for:
  - Lab environments you own, or  
  - Production environments where you have **explicit authorization** to test.
- **Do not** run this on networks where such testing violates policy, contracts, or law.

> **No Warranty**  
> This tool is provided "AS IS", without warranty of any kind, express or implied.  
> Use at your own risk. The author (**Steve Voto / Svoto**) assumes **no responsibility** for:
> - Outages or downtime  
> - Security incidents or misconfigurations  
> - Policy, compliance, or legal violations  
> resulting from use or misuse of this tool.

---

## Contents

This repo is built around a single one-shot installer and the Python test script it generates:

- `install_eicar_av_test.sh`  
  One-shot installer that:
  - Creates `/usr/local/eicar-av-test/`
  - Writes `eicar_router_test.py` into that directory
  - Creates a systemd **service** and **timer**
  - Reloads systemd
  - Enables + starts the timer
  - Immediately runs one test via the service

- `eicar_router_test.py` (generated by the installer)  
  Python script that:
  - Sends multiple EICAR test patterns over:
    - HTTP POST
    - HTTP multipart upload
    - HTTPS POST
    - Encoded payloads (Base64, hex, URL-encoded, double-encoded)
    - Raw sockets
    - PUT (FTP-like simulation)
    - DNS-like patterns
    - WebSocket-like JSON payloads
  - Generates a **summary report** of which paths were blocked/allowed
  - Supports:
    - `--no-prompt` (non-interactive mode)
    - `--interval` and `--runs` for self-looping runs (optional)

- `eicar-av-test.service` (created by installer)  
  Systemd unit that runs `eicar_router_test.py --no-prompt` once.

- `eicar-av-test.timer` (created by installer)  
  Systemd timer that triggers the service:
  - ~5 minutes after boot
  - Then **every 12 hours** after each run finishes

---

## Requirements

- Linux system with:
  - `systemd`
  - `python3`
- Outbound network access to:
  - `httpbin.org`
  - `postman-echo.com`
  - (optionally) your own webhook endpoints if you customize the script
- Permission to run EICAR tests on the target network.

---

## Quick Start

### 1. Clone the Repo

```bash
git clone https://github.com/<your-username>/<your-repo>.git
cd <your-repo>
